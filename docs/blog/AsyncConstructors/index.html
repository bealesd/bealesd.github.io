<!DOCTYPE html><html lang="en" style="--search-bar-menu-bar-height:0px;"><head><meta name="generator" content="Scully 1.1.1">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>David Beales Blog</title>
    <base href="/">

    <link rel="icon" type="image/png" href="assets/favicon-32x32.png" sizes="32x32">
    <script src="assets/prism/prism.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <link rel="stylesheet" href="assets/prism/prism.css" type="text/css" media="all" onload="this.media='all'"><noscript><link rel="stylesheet" href="assets/prism/prism.css"></noscript>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1J5EH52KLF"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'G-1J5EH52KLF');
    </script>

<style>@font-face{font-family:Space Mono;src:url(space-mono-v6-latin-regular.c7c481806f12eac88658.woff) format("woff");font-weight:400;font-style:normal;font-display:swap;}:root{--alert-success-color:21,87,36;--alert-success-background-color:212,237,218;--alert-success-border-color:195,230,203;--alert-info-color:12,84,96;--alert-info-background-color:209,236,241;--alert-info-border-color:190,229,235;--alert-warning-color:133,100,4;--alert-warning-background-color:255,243,205;--alert-warning-border-color:195,230,203;--alert-danger-color:114,28,36;--alert-danger-background-color:248,215,218;--alert-danger-border-color:245,198,203;--active-link-green:#2fcf11;--javascript-bg-color:#cd5b9f;--typescript-bg-color:#5e76bf;--azure-bg-color:#47bcd4;--sub-tag-bg-color:#c78855;--menu-bar-height:51px;--search-bar-menu-bar-height:0px;--menu-bar-total-height:calc(var(--menu-bar-height) + var(--search-bar-menu-bar-height));}body{width:100%;height:100%;margin:0;font-family:Space Mono;}body::-webkit-scrollbar{width:15px;height:15px;}body::-webkit-scrollbar-track{background:linear-gradient(90deg,#fff,#fff 1px,#fff 0,#fff);}body::-webkit-scrollbar-thumb{background:linear-gradient(0deg,#155724,#721c24);background:linear-gradient(0deg,rgba(var(--alert-success-color),1),rgba(var(--alert-danger-color),1));border-radius:10px;box-shadow:inset 2px 2px 2px hsla(0,0%,100%,.25),inset -2px -2px 2px rgba(0,0,0,.25);}</style><link rel="stylesheet" href="styles.080e51a9652ea4b44d97.css" media="all" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles.080e51a9652ea4b44d97.css"></noscript><style>[_nghost-lkw-c20]{--router-outlet-vertical-padding:20px;--router-outlet-padding-top:calc(var(--menu-bar-total-height) + var(--router-outlet-vertical-padding));--main-bg-color:#f8f8f8;--footer-height:15px}app-menu-bar[_ngcontent-lkw-c20]{position:fixed;top:0;width:100%;z-index:2}.main-container[_ngcontent-lkw-c20]{background-color:var(--main-bg-color);min-height:calc(100vh - (var(--router-outlet-padding-top) + var(--router-outlet-vertical-padding) + var(--footer-height)));padding-top:var(--router-outlet-padding-top);padding-bottom:var(--router-outlet-vertical-padding)}.blog[_ngcontent-lkw-c20]{max-width:700px;margin:0 auto;padding:10px 20px;background-color:#fff;border:1px solid #d3d3d3}footer[_ngcontent-lkw-c20]{background-color:var(--main-bg-color);font-size:10px;text-align:center;max-height:var(--footer-height)}.modal[_ngcontent-lkw-c20]{z-index:3;width:100vw;height:100vh;background-color:rgba(0,0,0,.8);cursor:zoom-out}.modal[_ngcontent-lkw-c20], .modal[_ngcontent-lkw-c20]   img[_ngcontent-lkw-c20]{position:fixed;bottom:0;left:0;right:0;top:0}.modal[_ngcontent-lkw-c20]   img[_ngcontent-lkw-c20]{max-width:100%;width:100%;max-height:100%;margin:auto;overflow:auto;-o-object-fit:contain;object-fit:contain}</style><style>[_nghost-lkw-c17]{--menu-bar-item-margin:20px;--menu-bar-search-item-margin:20px;--search-width:200px;--home-icon-font-size:28px;--menu-bar-item-display:inline}@media screen and (max-width: 800px) and (min-width: 600px){[_nghost-lkw-c17]{--menu-bar-search-item-margin:10px;--search-width:150px;--menu-bar-item-display:inline}}@media screen and (max-width: 600px){[_nghost-lkw-c17]{--menu-bar-item-margin:10px;--menu-bar-search-item-margin:5px;--search-width:100px;--home-icon-font-size:28px;--menu-bar-item-display:none}}.menu-bar-container[_ngcontent-lkw-c17]{height:50px;grid-template-columns:repeat(3,-webkit-min-content) 1fr;grid-template-columns:repeat(3,min-content) 1fr;grid-column-gap:var(--menu-bar-item-margin);-moz-column-gap:var(--menu-bar-item-margin);column-gap:var(--menu-bar-item-margin);justify-content:left}.menu-bar-container[_ngcontent-lkw-c17], .menu-bar-search-container[_ngcontent-lkw-c17]{position:relative;align-items:center;width:100%;background-color:#eee;color:#000;border-bottom:1px solid #d3d3d3;display:grid}.menu-bar-search-container[_ngcontent-lkw-c17]{height:35px;grid-template-columns:repeat(1,-webkit-min-content) auto auto auto;grid-template-columns:repeat(1,min-content) auto auto auto;grid-column-gap:var(--menu-bar-search-item-margin);-moz-column-gap:var(--menu-bar-search-item-margin);column-gap:var(--menu-bar-search-item-margin);justify-content:center}#searchInput[_ngcontent-lkw-c17]{max-width:var(--search-width);padding:none;margin:none;border:none;border-radius:5px}.sort-name[_ngcontent-lkw-c17], .sort-tag[_ngcontent-lkw-c17], .sort-timestamp[_ngcontent-lkw-c17]{font-size:16px}.menu-link[_ngcontent-lkw-c17] > span[_ngcontent-lkw-c17], .sort-name[_ngcontent-lkw-c17] > div[_ngcontent-lkw-c17], .sort-tag[_ngcontent-lkw-c17] > div[_ngcontent-lkw-c17], .sort-timestamp[_ngcontent-lkw-c17] > div[_ngcontent-lkw-c17]{border-radius:5px;transition:.2s ease-in-out}.menu-link[_ngcontent-lkw-c17] > span[_ngcontent-lkw-c17]:hover, .sort-name[_ngcontent-lkw-c17] > div[_ngcontent-lkw-c17]:hover, .sort-tag[_ngcontent-lkw-c17] > div[_ngcontent-lkw-c17]:hover, .sort-timestamp[_ngcontent-lkw-c17] > div[_ngcontent-lkw-c17]:hover{cursor:pointer;color:var(--active-link-green)}.menu-link[_ngcontent-lkw-c17] > span.active-link[_ngcontent-lkw-c17], [class*=sort-].active[_ngcontent-lkw-c17]{color:var(--active-link-green)}.menu-link[_ngcontent-lkw-c17]{font-size:var(--home-icon-font-size);transition:.2s ease-in-out}.menu-link[_ngcontent-lkw-c17] > span[_ngcontent-lkw-c17]:active, .menu-link[_ngcontent-lkw-c17] > span[_ngcontent-lkw-c17]:focus{outline:0;border:none}.menu-link.right[_ngcontent-lkw-c17]{text-align:right}.menu-link.right[_ngcontent-lkw-c17]   div[_ngcontent-lkw-c17], .menu-link.right[_ngcontent-lkw-c17]   span[_ngcontent-lkw-c17]{margin-right:var(--menu-bar-item-margin)}.menu-author[_ngcontent-lkw-c17]{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;text-align:center}.menu-author[_ngcontent-lkw-c17]   div[_ngcontent-lkw-c17]{font-family:ps-regular;text-transform:uppercase;font-size:14px}.hamburger[_ngcontent-lkw-c17]{display:inline-block}.hamburger[_ngcontent-lkw-c17]:hover{cursor:pointer}.bar1[_ngcontent-lkw-c17]{margin-top:5px!important}.bar1[_ngcontent-lkw-c17], .bar2[_ngcontent-lkw-c17], .bar3[_ngcontent-lkw-c17]{width:20px;height:5px;background-color:#333;margin:3px 5px;transition:.4s}.change[_ngcontent-lkw-c17]   .bar1[_ngcontent-lkw-c17]{transform:rotate(-45deg) translate(-5px,5px)}.change[_ngcontent-lkw-c17]   .bar2[_ngcontent-lkw-c17]{opacity:0}.change[_ngcontent-lkw-c17]   .bar3[_ngcontent-lkw-c17]{transform:rotate(45deg) translate(-6px,-6px)}.sidebar[_ngcontent-lkw-c17]{top:var(--menu-bar-total-height);background-color:#eee;color:#000;border-right:1px solid #d3d3d3;font-size:16px;width:250px;position:fixed;overflow-y:auto;bottom:0}.sidebar-sub-headers-hidden[_ngcontent-lkw-c17]{display:none}.sidebar-header[_ngcontent-lkw-c17], .sidebar-header-tag[_ngcontent-lkw-c17], .sidebar-sub-headers[_ngcontent-lkw-c17]{border-bottom:1px solid #d3d3d3}.sidebar-header[_ngcontent-lkw-c17]{padding:8px}.sidebar-header-tag[_ngcontent-lkw-c17]{padding:8px 16px}.sidebar-sub-header[_ngcontent-lkw-c17]{padding:8px 26px}.sidebar-header-tag[_ngcontent-lkw-c17]   [class^=icon-][_ngcontent-lkw-c17]{font-size:10px}[class*=sidebar-][_ngcontent-lkw-c17]:hover{color:var(--active-link-green);cursor:pointer}[class*=sidebar-][_ngcontent-lkw-c17]:active, [class*=sidebar-][_ngcontent-lkw-c17]:focus{outline:0;border:none}.sidebar[_ngcontent-lkw-c17]   [class*=icon][_ngcontent-lkw-c17]{font-size:8px}.sidebar[_ngcontent-lkw-c17]   .icon-minus[_ngcontent-lkw-c17]{color:red}.sidebar-header.active-link[_ngcontent-lkw-c17], .sidebar-sub-header.active-link[_ngcontent-lkw-c17], .sidebar[_ngcontent-lkw-c17]   .icon-plus[_ngcontent-lkw-c17]{color:var(--active-link-green)}</style><style>[_ngcontent-lkw-c18]:root{--alert-success-color:21,87,36;--alert-success-background-color:212,237,218;--alert-success-border-color:195,230,203;--alert-info-color:12,84,96;--alert-info-background-color:209,236,241;--alert-info-border-color:190,229,235;--alert-warning-color:133,100,4;--alert-warning-background-color:255,243,205;--alert-warning-border-color:195,230,203;--alert-danger-color:114,28,36;--alert-danger-background-color:248,215,218;--alert-danger-border-color:245,198,203}.message[_ngcontent-lkw-c18]{z-index:9999;position:absolute;bottom:10px;right:0}.alert[_ngcontent-lkw-c18]{font-size:12px;text-align:center;width:120px;min-height:40px;margin-top:10px;margin-right:10px;border-radius:10px;position:relative;display:flex;align-items:center;justify-content:center}.alert-info[_ngcontent-lkw-c18]{color:#0c5460;color:rgb(var(--alert-info-color));background-color:rgba(209,236,241,.8);background-color:rgba(var(--alert-info-background-color),.8);border:1px solid #0c5460;border:1px solid rgb(var(--alert-info-color))}.alert-interactive[_ngcontent-lkw-c18]{color:#155724;color:rgb(var(--alert-success-color));background-color:rgba(212,237,218,.8);background-color:rgba(var(--alert-success-background-color),.8);border:1px solid #155724;border:1px solid rgb(var(--alert-success-color))}.alert-interactive[_ngcontent-lkw-c18]:hover{color:#d1ecf1;color:rgb(var(--alert-info-background-color));background-color:rgba(12,84,96,.8);background-color:rgba(var(--alert-info-color),.8);cursor:pointer}#toast-message-container[_ngcontent-lkw-c18]{display:grid;grid-template-columns:3fr 1fr;width:100%}#toast-close-icon[_ngcontent-lkw-c18]{align-self:center;font-size:20px}#toast-message[_ngcontent-lkw-c18]{align-self:center}</style><style>.message[_ngcontent-lkw-c19]{z-index:9999;position:absolute;bottom:10px;right:0}.alert[_ngcontent-lkw-c19]{font-size:12px;text-align:center;width:120px;height:40px;margin-top:10px;margin-right:10px;border-radius:10px;position:relative;display:flex;align-items:center;justify-content:center}.alert-info[_ngcontent-lkw-c19]{color:rgb(var(--alert-info-color));background-color:rgba(var(--alert-info-background-color),.8);border:1px solid rgb(var(--alert-info-color))}.alert-interactive[_ngcontent-lkw-c19]{color:rgb(var(--alert-success-color));background-color:rgba(var(--alert-success-background-color),.8);border:1px solid rgb(var(--alert-success-color))}.alert-interactive[_ngcontent-lkw-c19]:hover{color:rgb(var(--alert-info-background-color));background-color:rgba(var(--alert-info-color),.8);cursor:pointer}[class^=icon-][_ngcontent-lkw-c19]{font-size:10px;padding-left:5px}</style><style></style><meta name="description" property="description" content=" Use async constructors in JavaScript, with closures."><script>window['ScullyIO']='generated';</script></head>

<body scully-version="1.1.1">
    <app-root _nghost-lkw-c20="" ng-version="12.1.4"><app-menu-bar _ngcontent-lkw-c20="" _nghost-lkw-c17=""><div _ngcontent-lkw-c17="" class="menu-bar-container"><div _ngcontent-lkw-c17="" class="hamburger"><div _ngcontent-lkw-c17="" class="bar1"></div><div _ngcontent-lkw-c17="" class="bar2"></div><div _ngcontent-lkw-c17="" class="bar3"></div></div><div _ngcontent-lkw-c17="" class="menu-link"><span _ngcontent-lkw-c17="" routerlink="/home" routerlinkactive="active-link" class="icon-home" tabindex="0"></span></div><div _ngcontent-lkw-c17="" class="menu-link"><span _ngcontent-lkw-c17="" routerlink="/about" routerlinkactive="active-link" class="icon-profile" tabindex="0"></span></div><div _ngcontent-lkw-c17="" class="menu-link right"><span _ngcontent-lkw-c17="" class="icon-github"></span><span _ngcontent-lkw-c17="" class="icon-linkedin"></span><span _ngcontent-lkw-c17="" class="icon-envelop"></span><!----><div _ngcontent-lkw-c17="" class="menu-author"><div _ngcontent-lkw-c17="">David Beales</div></div></div></div><!----><!----></app-menu-bar><div _ngcontent-lkw-c20="" class="main-container"><div _ngcontent-lkw-c20="" class="blog"><router-outlet _ngcontent-lkw-c20=""></router-outlet><app-async-constructors _nghost-lkw-c10=""><h1 _ngcontent-lkw-c10=""> The Async Constructor </h1><h2 _ngcontent-lkw-c10=""> The Problem </h2><p _ngcontent-lkw-c10=""> You want to run some asynchronous code in your class constructor. You wisely believe that adding <i _ngcontent-lkw-c10="">async</i> before the word <i _ngcontent-lkw-c10="">constructor</i> will work, as shown below (figure 1).
</p><h4 _ngcontent-lkw-c10=""> Figure 1 - async constructor (not working)</h4><div class="code-toolbar"><pre _ngcontent-lkw-c10="" class="example-bad  language-javascript"><code _ngcontent-lkw-c10="" class="  language-javascript"><span class="token keyword">class</span> <span class="token class-name">GoogleClass</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://www.google.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">...</span>some logic<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button type="button">Copy</button></div></div></div><p _ngcontent-lkw-c10=""> Alas, your class fails to build, you get an error: <i _ngcontent-lkw-c10="">Uncaught SyntaxError: Class constructor may not be an async method</i>.
</p><hr _ngcontent-lkw-c10=""><h2 _ngcontent-lkw-c10=""> The Solution</h2><p _ngcontent-lkw-c10=""> So there is a really simple solution, return a function in the constructor, i.e. a closure. In this case (figure 2), we create an anonymous async function, that we instantly return on newing up the class with the <i _ngcontent-lkw-c10="">new</i> operator.
</p><h4 _ngcontent-lkw-c10=""> Figure 2 - async constructor (working)</h4><div class="code-toolbar"><pre _ngcontent-lkw-c10="" class="example-good  language-javascript"><code _ngcontent-lkw-c10="" class="  language-javascript"><span class="token keyword">class</span> <span class="token class-name">GoogleClass</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://www.google.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token operator">...</span>some logic<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><div class="toolbar"><div class="toolbar-item"><span>JavaScript</span></div><div class="toolbar-item"><button type="button">Copy</button></div></div></div></app-async-constructors><!----></div></div><db-toasts _ngcontent-lkw-c20="" _nghost-lkw-c18=""><div _ngcontent-lkw-c18="" class="message"><!----></div></db-toasts><app-message-box _ngcontent-lkw-c20="" _nghost-lkw-c19=""><div _ngcontent-lkw-c19="" class="message"><!----></div></app-message-box><footer _ngcontent-lkw-c20="">Copyright © 2020 - 2021, David Beales. All Rights Reserved. </footer><!----></app-root>
<script id="ScullyIO-transfer-state"></script><script src="runtime-es2015.c804abedc9578d1d5b9b.js" type="module"></script><script src="runtime-es5.c804abedc9578d1d5b9b.js" nomodule="" defer=""></script><script src="polyfills-es5.89df1761b0246eae0b6b.js" nomodule="" defer=""></script><script src="polyfills-es2015.a3817aa7da1be37c6c5e.js" type="module"></script><script src="main-es2015.2aa610186dbe4a9073fc.js" type="module"></script><script src="main-es5.2aa610186dbe4a9073fc.js" nomodule="" defer=""></script>


</body></html>